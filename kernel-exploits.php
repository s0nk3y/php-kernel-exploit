<?php
#!/usr/bin/env php

/**
*  PHP Kernel Exploits
*  ========================================
*
*  @author s0nk3y <s0nk3y[at]gmail[dot]com>
*  @version 1.0
*  
*  @license GPL
*  @category security
*  @copyright (c) 2016
*
*  This program is free software: you can redistribute it and/or modify
*  it under the terms of the GNU General Public License as published by
*  the Free Software Foundation, either version 3 of the License, or
*  (at your option) any later version.
*
*  This program is distributed in the hope that it will be useful,
*  but WITHOUT ANY WARRANTY; without even the implied warranty of
*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
*  GNU General Public License for more details.
*
*  You should have received a copy of the GNU General Public License
*  along with this program.  If not, see <http://www.gnu.org/licenses/>.
*
*/

print "PHP Kernel Exploits\n";
print "==========================\n";

$kernel = "";

if (count($argv) > 1) {
   $kernel = $argv[1];
} else {
   $kernel = str_replace("-","",substr(@php_uname("r"),0,6));     
}

print "\nKernel local: ". $kernel."\n";
print "\nPossible Exploits:\n";

$kernel_count = 0;
$exploits = get_exploits();

foreach ($exploits as $name => $exploit) {
    foreach ($exploit['vuln'] as $kernel_version) {
        if($kernel_version == $kernel) {    
            print "[+] ". $name."\n";
            print "    ";
            print $exploit['cve'] ? "CVE-".$exploit['cve'] : "N/A";
            print "\n";
            print "    ".$exploit['link']."\n";
            print "\n";

            $kernel_count += 1;           
        } 
    }
}

print "[+] Found ".$kernel_count." Local Kernel Exploit\n";

print "\n[+] https://www.google.com/search?q=site:exploit-db.com+linux+kernel+".$kernel;
print "\n[+] http://0day.today/search?search_request=linux+kernel+".$kernel;
print "\n[+] https://www.kernel-exploits.com/kernel/?version=".$kernel;
print "\n\n";

function get_exploits() {
   $kernels = array(
        'Linux Kernel <= 4.4.1 - REFCOUNT Overflow/Use-After-Free in Keyrings Local Root (2)' => array(
            'vuln' => array('4.4.1'),
            'cve'  => '2016-0728',
            'link' => 'https://www.exploit-db.com/exploits/40003/'
            ),

        'Linux Kernel 4.4.x (Ubuntu 16.04) - double-fdput() in bpf(BPF_PROG_LOAD) Local Root Exploit' => array(
            'vuln' => array('4.4.0'),
            'cve'  => '2016-4557',
            'link' => 'https://www.exploit-db.com/exploits/39772/'
            ),

        '2.6 UDEV < 141 Local Privilege Escalation Exploit' => array(
            'vuln' => array('2.6','2.6.2','2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29'),
            'cve'  => '2009-1185',
            'link' => 'http://www.exploit-db.com/exploits/8572'
            ),

        'pp_key' => array(
            'vuln' => array('3.8.0', '3.8.1', '3.8.2', '3.8.3', '3.8.4', '3.8.5', '3.8.6', 
                '3.8.7', '3.8.8', '3.8.9', '3.9', '3.10', '3.11', '3.12', '3.13', '3.4.0', 
                '3.5.0', '3.6.0', '3.7.0', '3.8.0', '3.8.5', '3.8.6', '3.8.9', '3.9.0',
                '3.9.6', '3.10.0', '3.10.6', '3.11.0', '3.12.0', '3.13.0', '3.13.1'),
            'cve'  => '2016-0728',
            'link' => 'https://www.kernel-exploits.com/media/pp_key_64.c'
            ),

       'overlayfs' => array(
            'vuln' => array('3.13','3.16','3.19'),
            'cve'  => '2015-1328',
            'link' => 'https://www.exploit-db.com/exploits/37292/'
            ),

        'Test Kernel Local Root Exploit 0day' => array(
            'vuln' => array('2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22','2.6.23',
                            '2.6.24','2.6.25','2.6.26','2.6.27','2.6.28','2.6.29',
                            '2.6.30'),
            'cve'  => '',
            'link' => 'http://www.exploit-db.com/exploits/9191'
            ),

        '(proc) Local Root Exploit' => array(
            'vuln' => array(
                '2.6.8',  '2.6.10', '2.6.11', '2.6.12',
                '2.6.13', '2.6.14', '2.6.15', '2.6.16'
            ),
            'cve' => '2006-3626',
            'link' => 'http://www.exploit-db.com/exploits/2013/'
            ),
        'krad3' => array(
            'vuln' => array('2.6.5', '2.6.7', '2.6.8', '2.6.9', '2.6.10', '2.6.11'),
            'link' => 'http://exploit-db.com/exploits/1397',
            ),
         'mremap_pte' => array(
            'vuln' => array( '2.4.20', '2.2.24', '2.4.25', '2.4.26', '2.4.27' ),
            'link' => 'http://www.exploit-db.com/exploits/160/'),

         'ptrace_kmod2' => array(
            'vuln' => array(
                '2.6.26', '2.6.27', '2.6.28', '2.6.29', '2.6.30', '2.6.31',
                '2.6.32', '2.6.33', '2.6.34',
            ),
            'alt' => 'ia32syscall,robert_you_suck',
            'link' => 'http://www.exploit-db.com/exploits/15023/',
            'cve' => '2010-3301'),

         'full-nelson' => array(
            'vuln' => array(
                '2.6.37','2.6.36','2.6.35','2.6.34','2.6.33','2.6.16','2.6.15',
                '2.6.14','2.6.13','2.6.12','2.6.11','2.6','2.6.32'),
            'link' => 'http://www.exploit-db.com/exploits/15704/',
            'cve' => '2010-4258'),

         '2.6.13 <= 2.6.17.4 prctl() Local Root Exploit (logrotate)' => array(
            'vuln' => array( '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17' ),
            'cve'  => '2006-2451',
            'link' => 'http://www.exploit-db.com/exploits/2031/'),
        
        '2.6.13 <= 2.6.17.4 sys_prctl() Local Root Exploit' => array(
            'vuln' => array( '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17' ),
            'cve' => '',
            'link' => 'http://www.exploit-db.com/exploits/2004/'),
        
        '2.6.13 <= 2.6.17.4 sys_prctl() Local Root Exploit (2)' => array(
            'vuln' => array( '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17' ),
            'cve' => '',
            'link' => 'http://www.exploit-db.com/exploits/2005/'),
        
        '2.6.13 <= 2.6.17.4 sys_prctl() Local Root Exploit (3)' => array(
            'vuln' => array( '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17' ),
            'cve' => '',
            'link' => 'http://www.exploit-db.com/exploits/2006/'),
        
        '2.6.13 <= 2.6.17.4 sys_prctl() Local Root Exploit (4)' => array(
            'vuln' => array( '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17' ),
            'cve' => '',
            'link' => 'http://www.exploit-db.com/exploits/2011/'),

        'vmsplice1' => array(
            'vuln' => array(
                '2.6.2','2.6.17', '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22',
                '2.6.23', '2.6.24', '2.6.24.1'),
            'alt' => 'jessica biel',
            'cve' => '2008-0600',
            'link' => 'http://www.exploit-db.com/exploits/5092'
            ),
        
        'vmsplice2' => array(
            'vuln' => array( '2.6.2','2.6.23', '2.6.24' ),
            'alt'  => 'diane_lane',
            'cve'  => '2008-0600',
            'link'  => 'http://www.exploit-db.com/exploits/5093'),
        'ftrex' => array(
            'vuln' => array(
                '2.6.11', '2.6.12', '2.6.13', '2.6.14', '2.6.15', '2.6.16',
                '2.6.17', '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22',
            ),
            'cve' => '2008-4210',
            'link' => 'http://www.exploit-db.com/exploits/6851'),
        
        'exit_notify' => array(
            'vuln' => array( '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29' ),
            'cve' => '',
            'link' => 'http://www.exploit-db.com/exploits/8369'),
        
        'udev' => array(
            'vuln' => array( '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29' ),
            'alt'  => 'udev <1.4.1',
            'cve'  => '2009-1185',
            'link' => 'http://www.exploit-db.com/exploits/8478'),

        'sock_sendpage2' => array(
            'vuln' => array(
                '2.4.4',  '2.4.5',  '2.4.6',  '2.4.7',  '2.4.8',  '2.4.9',
                '2.4.10', '2.4.11', '2.4.12', '2.4.13', '2.4.14', '2.4.15',
                '2.4.16', '2.4.17', '2.4.18', '2.4.19', '2.4.20', '2.4.21',
                '2.4.22', '2.4.23', '2.4.24', '2.4.25', '2.4.26', '2.4.27',
                '2.4.28', '2.4.29', '2.4.30', '2.4.31', '2.4.32', '2.4.33',
                '2.4.34', '2.4.35', '2.4.36', '2.4.37', '2.6.0',  '2.6.1',
                '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',  '2.6.6',  '2.6.7',
                '2.6.8',  '2.6.9',  '2.6.10', '2.6.11', '2.6.12', '2.6.13',
                '2.6.14', '2.6.15', '2.6.16', '2.6.17', '2.6.18', '2.6.19',
                '2.6.20', '2.6.21', '2.6.22', '2.6.23', '2.6.24', '2.6.25',
                '2.6.26', '2.6.27', '2.6.28', '2.6.29', '2.6.30',
            ),
            'alt' => 'proto_ops',
            'cve' => '2009-2692',
            'link' => 'http://www.exploit-db.com/exploits/9436'),

            'ReiserFS xattr' => array(
            'vuln' => array(
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34',
            ),
            'cve' => '2010-1146',
            'link' => 'http://www.exploit-db.com/exploits/12130/'),
        
        'can_bcm' => array(
            'vuln' => array(
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34', '2.6.35',
                '2.6.36',
            ),
            'cve' => '2010-2959',
            'link' => 'http://www.exploit-db.com/exploits/14814/'),
        
        'rds' => array(
            'vuln' => array(
                '2.6.30', '2.6.31', '2.6.32', '2.6.33',
                '2.6.34', '2.6.35', '2.6.36',
            ),
            'link' => 'http://www.exploit-db.com/exploits/15285/',
            'cve' => '2010-3904'),
        
        'half_nelson' => array(
            'vuln' => array(
                '2.6.0',  '2.6.1',  '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',
                '2.6.6',  '2.6.7',  '2.6.8',  '2.6.9',  '2.6.10', '2.6.11',
                '2.6.12', '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17',
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34', '2.6.35',
                '2.6.36',
            ),
            'alt' => 'econet',
            'cve' => '2010-3848',
            'link' => 'http://www.exploit-db.com/exploits/6851'),

            'udp_sendmsg_32bit' => array(
            'vuln' => array(
                '2.6.1',  '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',  '2.6.6',
                '2.6.7',  '2.6.8',  '2.6.9',  '2.6.10', '2.6.11', '2.6.12',
                '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17', '2.6.18',
                '2.6.19'
            ),
            'cve' => '2009-2698',
            'link' =>
              'http://downloads.securityfocus.com/vulnerabilities/exploits/36108.c'),
        
        'pipe.c_32bit' => array(
            'vuln' => array(
                '2.4.4',  '2.4.5',  '2.4.6',  '2.4.7',  '2.4.8',  '2.4.9',
                '2.4.10', '2.4.11', '2.4.12', '2.4.13', '2.4.14', '2.4.15',
                '2.4.16', '2.4.17', '2.4.18', '2.4.19', '2.4.20', '2.4.21',
                '2.4.22', '2.4.23', '2.4.24', '2.4.25', '2.4.26', '2.4.27',
                '2.4.28', '2.4.29', '2.4.30', '2.4.31', '2.4.32', '2.4.33',
                '2.4.34', '2.4.35', '2.4.36', '2.4.37', '2.6.15', '2.6.16',
                '2.6.17', '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22',
                '2.6.23', '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28',
                '2.6.29', '2.6.30', '2.6.31'),
            'cve' => '2009-3547',
            'link' =>
              'http://www.securityfocus.com/data/vulnerabilities/exploits/36901-1.c'),
        'half_nelson1' => array(
            'vuln' => array(
                '2.6.0',  '2.6.1',  '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',
                '2.6.6',  '2.6.7',  '2.6.8',  '2.6.9',  '2.6.10', '2.6.11',
                '2.6.12', '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17',
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34', '2.6.35',
                '2.6.36'
            ),
            'alt' => 'econet',
            'cve' => '2010-3848',
            'link' => 'http://www.exploit-db.com/exploits/17787/'),
        
        'half_nelson2' => array(
            'vuln' => array(
                '2.6.0',  '2.6.1',  '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',
                '2.6.6',  '2.6.7',  '2.6.8',  '2.6.9',  '2.6.10', '2.6.11',
                '2.6.12', '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17',
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34', '2.6.35',
                '2.6.36'
            ),
            'alt' => 'econet',
            'cve' => '2010-3850',
            'link' => 'http://www.exploit-db.com/exploits/17787/'),
        
        'half_nelson3' => array(
            'vuln' => array(
                '2.6.0',  '2.6.1',  '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',
                '2.6.6',  '2.6.7',  '2.6.8',  '2.6.9',  '2.6.10', '2.6.11',
                '2.6.12', '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17',
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34', '2.6.35',
                '2.6.36'
            ),
            'alt' => 'econet',
            'cve' => '2010-4073',
            'link' => 'http://www.exploit-db.com/exploits/17787/'),
        
        'caps_to_root' => array(
            'vuln' => array( '2.6.34', '2.6.35', '2.6.36' ),
            'cve'  => 'n/a',
            'link' => 'http://www.exploit-db.com/exploits/15916/'),
        
        'american-sign-language' => array(
            'vuln' => array(
                '2.6.0',  '2.6.1',  '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',
                '2.6.6',  '2.6.7',  '2.6.8',  '2.6.9',  '2.6.10', '2.6.11',
                '2.6.12', '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17',
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34', '2.6.35',
                '2.6.36'
            ),
            'cve' => '2010-4347',
            'link' => 'http://www.securityfocus.com/bid/45408/'),
        
        'pktcdvd' => array(
            'vuln' => array(
                '2.6.0',  '2.6.1',  '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',
                '2.6.6',  '2.6.7',  '2.6.8',  '2.6.9',  '2.6.10', '2.6.11',
                '2.6.12', '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17',
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34', '2.6.35',
                '2.6.36'
            ),
            'cve' => '2010-3437',
            'link' => 'http://www.exploit-db.com/exploits/15150/'),
        
        'video4linux' => array(
            'vuln' => array(
                '2.6.0',  '2.6.1',  '2.6.2',  '2.6.3',  '2.6.4',  '2.6.5',
                '2.6.6',  '2.6.7',  '2.6.8',  '2.6.9',  '2.6.10', '2.6.11',
                '2.6.12', '2.6.13', '2.6.14', '2.6.15', '2.6.16', '2.6.17',
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.28', '2.6.29',
                '2.6.30', '2.6.31', '2.6.32', '2.6.33'
            ),
            'cve' => '2010-3081',
            'link' => 'http://www.exploit-db.com/exploits/15024/'),
        
        'memodipper' => array(
            'vuln' => array(
                '2.6.39', '3.0.0', '3.0.1', '3.0.2', '3.0.3', '3.0.4',
                '3.0.5',  '3.0.6', '3.1.0'
            ),
            'cve' => '2012-0056',
            'link' => 'http://www.exploit-db.com/exploits/18411/'),
        
        'PERF_EVENTS Local Root Exploit' => array(
            'vuln' => array(
                '2.6.30','2.6.32','2.6.33','2.6.37', '2.6.38', 
                '2.6.39', '3.0.0', '3.0.1', '3.0.2',
                '3.0.3',  '3.0.4',  '3.0.5',  '3.0.6', '3.1.0'
            ),
            'cve' => '2013-2094',
            'link' => 'http://www.exploit-db.com/exploits/25444/'),
        
        'perf_swevent' => array(
            'vuln' => array(
                '3.0.0', '3.0.1', '3.0.2', '3.0.3', '3.0.4', '3.0.5',
                '3.0.6', '3.1.0', '3.2',   '3.3',   '3.4.0', '3.4.1',
                '3.4.2', '3.4.3', '3.4.4', '3.4.5', '3.4.6', '3.4.8',
                '3.4.9', '3.5',   '3.6',   '3.7',   '3.8.0', '3.8.1',
                '3.8.2', '3.8.3', '3.8.4', '3.8.5', '3.8.6', '3.8.7',
                '3.8.8', '3.8.9'
            ),
            'cve' => '2013-2094',
            'link' => 'http://www.exploit-db.com/exploits/26131'),

        '2.6.18-20 2009 Local Root Exploit' => array(
            'vuln' => array(
                '2.6.18','2.6.19','2.6.20'
            ),
            'cve' => 'n/a',
            'link' => 'http://www.exploit-db.com/download/10613'),

        'msr' => array(
            'vuln' => array(
                '2.6.18', '2.6.19', '2.6.20', '2.6.21', '2.6.22', '2.6.23',
                '2.6.24', '2.6.25', '2.6.26', '2.6.27', '2.6.27', '2.6.28',
                '2.6.29', '2.6.30', '2.6.31', '2.6.32', '2.6.33', '2.6.34',
                '2.6.35', '2.6.36', '2.6.37', '2.6.38', '2.6.39', '3.0.0',
                '3.0.1',  '3.0.2',  '3.0.3',  '3.0.4',  '3.0.5',  '3.0.6',
                '3.1.0',  '3.2',    '3.3',    '3.4',    '3.5',    '3.6',
                '3.7.0',  '3.7.6'),
            'cve' => '2013-0268',
            'link' => 'http://www.exploit-db.com/exploits/27297/'),
        
        'timeoutpwn' => array(
            'vuln' => array(
                '3.4',  '3.5',    '3.6',    '3.7',   '3.8',   '3.8.9', '3.9', '3.10', 
            '3.11', '3.12',   '3.13',   '3.4.0', '3.5.0', '3.6.0', '3.7.0',
                '3.8.0','3.8.5',  '3.8.6',  '3.8.9', '3.9.0', '3.9.6', 
                '3.10.0','3.10.6', '3.11.0','3.12.0','3.13.0','3.13.1'
            ),
            'cve' => '2014-0038',
            'link' => 'http://www.exploit-db.com/exploits/31346/'),
        
        'Local Privilege Escalation PoC (gid)' => array(
            'vuln' => array(
                '3.4',  '3.5',    '3.6',    '3.7',   '3.8',   '3.8.9', '3.9', '3.10', 
            '3.11', '3.12',   '3.13',   '3.4.0', '3.5.0', '3.6.0', '3.7.0',
                '3.8.0','3.8.5',  '3.8.6',  '3.8.9', '3.9.0', '3.9.6', 
                '3.10.0','3.10.6', '3.11.0','3.12.0','3.13.0','3.13'
            ),
            'cve' => '2014-4014',
            'link' => 'http://www.exploit-db.com/exploits/33824/'
            ),

        'rawmodePTY' => array(
            'vuln' => array(
                 '2.6.31', '2.6.32', '2.6.33', '2.6.34', '2.6.35', '2.6.36', '2.6.37',
                 '2.6.38', '2.6.39', '3.14', '3.15'
            ),
            'cve' => '2014-0196',
            'link' => 'http://packetstormsecurity.com/files/download/126603/cve-2014-0196-md.c')
        );
    
    return $kernels;
}
?>
